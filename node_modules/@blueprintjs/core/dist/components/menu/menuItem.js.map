{"version":3,"sources":["../src/components/menu/menuItem.tsx"],"names":[],"mappings":"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","file":"menuItem.js","sourcesContent":["/*\n * Copyright 2015 Palantir Technologies, Inc. All rights reserved.\n * Licensed under the BSD-3 License as modified (the “License”); you may obtain a copy\n * of the license at https://github.com/palantir/blueprint/blob/master/LICENSE\n * and https://github.com/palantir/blueprint/blob/master/PATENTS\n */\n\nimport * as classNames from \"classnames\";\nimport * as React from \"react\";\nimport * as ReactDOM from \"react-dom\";\n\nimport { AbstractComponent } from \"../../common/abstractComponent\";\nimport * as Classes from \"../../common/classes\";\nimport * as Errors from \"../../common/errors\";\nimport { Position } from \"../../common/position\";\nimport { IActionProps, ILinkProps } from \"../../common/props\";\nimport { IPopoverProps, Popover, PopoverInteractionKind } from \"../popover/popover\";\nimport { Menu } from \"./menu\";\n\nexport interface IMenuItemProps extends IActionProps, ILinkProps {\n    // override from IActionProps to make it required\n    /** Item text, required for usability. */\n    text: string;\n\n    /**\n     * Right-aligned label content, useful for displaying hotkeys.\n     */\n    label?: string | JSX.Element;\n\n    /** Props to spread to `Popover`. Note that `content` cannot be changed. */\n    popoverProps?: Partial<IPopoverProps> & object;\n\n    /**\n     * Whether an enabled, non-submenu item should automatically close the\n     * popover it is nested within when clicked.\n     * @default true\n     */\n    shouldDismissPopover?: boolean;\n\n    /**\n     * Array of props objects for submenu items.\n     * An alternative to providing `MenuItem` components as `children`.\n     */\n    submenu?: IMenuItemProps[];\n\n    /**\n     * Width of `margin` from left or right edge of viewport. Submenus will\n     * flip to the other side if they come within this distance of that edge.\n     * This has no effect if omitted or if `useSmartPositioning` is set to `false`.\n     * Note that these values are not CSS properties; they are used in\n     * internal math to determine when to flip sides.\n     */\n    submenuViewportMargin?: { left?: number; right?: number };\n\n    /**\n     * Whether a submenu popover will try to reposition itself\n     * if there isn't room for it in its current position.\n     * The popover opens right by default, but will try to flip\n     * left if not enough space.\n     * @default true\n     */\n    useSmartPositioning?: boolean;\n}\n\nexport interface IMenuItemState {\n    /** Whether a submenu is opened to the left */\n    alignLeft?: boolean;\n}\n\nconst REACT_CONTEXT_TYPES: React.ValidationMap<IMenuItemState> = {\n    alignLeft: (obj: IMenuItemState, key: keyof IMenuItemState) => {\n        if (obj[key] != null && typeof obj[key] !== \"boolean\") {\n            return new Error(\"[Blueprint] MenuItem context alignLeft must be boolean\");\n        }\n        return undefined;\n    },\n};\n\nexport class MenuItem extends AbstractComponent<IMenuItemProps, IMenuItemState> {\n    public static defaultProps: IMenuItemProps = {\n        disabled: false,\n        popoverProps: {},\n        shouldDismissPopover: true,\n        submenuViewportMargin: {},\n        text: \"\",\n        useSmartPositioning: true,\n    };\n    public static displayName = \"Blueprint.MenuItem\";\n\n    public static contextTypes = REACT_CONTEXT_TYPES;\n    public static childContextTypes = REACT_CONTEXT_TYPES;\n    public context: IMenuItemState;\n\n    public state: IMenuItemState = {\n        alignLeft: false,\n    };\n\n    private liElement: HTMLElement;\n\n    public render() {\n        const { children, disabled, label, submenu, popoverProps } = this.props;\n        const hasSubmenu = children != null || submenu != null;\n        const liClasses = classNames({\n            [Classes.MENU_SUBMENU]: hasSubmenu,\n        });\n        const anchorClasses = classNames(\n            Classes.MENU_ITEM,\n            Classes.intentClass(this.props.intent),\n            {\n                [Classes.DISABLED]: disabled,\n                // prevent popover from closing when clicking on submenu trigger or disabled item\n                [Classes.POPOVER_DISMISS]: this.props.shouldDismissPopover && !disabled && !hasSubmenu,\n            },\n            Classes.iconClass(this.props.iconName),\n            this.props.className,\n        );\n\n        let labelElement: JSX.Element;\n        if (label != null) {\n            labelElement = <span className=\"pt-menu-item-label\">{label}</span>;\n        }\n\n        let content = (\n            <a\n                className={anchorClasses}\n                href={disabled ? undefined : this.props.href}\n                onClick={disabled ? undefined : this.props.onClick}\n                tabIndex={disabled ? undefined : 0}\n                target={this.props.target}\n            >\n                {labelElement}\n                {this.props.text}\n            </a>\n        );\n\n        if (hasSubmenu) {\n            const measureSubmenu = this.props.useSmartPositioning ? this.measureSubmenu : null;\n            const submenuElement = <Menu ref={measureSubmenu}>{this.renderChildren()}</Menu>;\n            const popoverClasses = classNames(Classes.MINIMAL, Classes.MENU_SUBMENU, popoverProps.popoverClassName, {\n                [Classes.ALIGN_LEFT]: this.state.alignLeft,\n            });\n\n            content = (\n                <Popover\n                    isDisabled={disabled}\n                    enforceFocus={false}\n                    hoverCloseDelay={0}\n                    inline={true}\n                    interactionKind={PopoverInteractionKind.HOVER}\n                    position={this.state.alignLeft ? Position.LEFT_TOP : Position.RIGHT_TOP}\n                    useSmartArrowPositioning={false}\n                    {...popoverProps}\n                    content={submenuElement}\n                    popoverClassName={popoverClasses}\n                >\n                    {content}\n                </Popover>\n            );\n        }\n\n        return (\n            <li className={liClasses} ref={this.liRefHandler}>\n                {content}\n            </li>\n        );\n    }\n\n    public getChildContext() {\n        return { alignLeft: this.state.alignLeft };\n    }\n\n    protected validateProps(props: IMenuItemProps & { children?: React.ReactNode }) {\n        if (props.children != null && props.submenu != null) {\n            console.warn(Errors.MENU_WARN_CHILDREN_SUBMENU_MUTEX);\n        }\n    }\n\n    private liRefHandler = (r: HTMLElement) => (this.liElement = r);\n\n    private measureSubmenu = (el: Menu) => {\n        if (el != null) {\n            const submenuRect = ReactDOM.findDOMNode(el).getBoundingClientRect();\n            const parentWidth = this.liElement.parentElement.getBoundingClientRect().width;\n            const adjustmentWidth = submenuRect.width + parentWidth;\n\n            // this ensures that the left and right measurements represent a submenu opened to the right\n            let submenuLeft = submenuRect.left;\n            let submenuRight = submenuRect.right;\n            if (this.state.alignLeft) {\n                submenuLeft += adjustmentWidth;\n                submenuRight += adjustmentWidth;\n            }\n\n            const { left = 0 } = this.props.submenuViewportMargin;\n            let { right = 0 } = this.props.submenuViewportMargin;\n            if (\n                typeof document !== \"undefined\" &&\n                typeof document.documentElement !== \"undefined\" &&\n                Number(document.documentElement.clientWidth)\n            ) {\n                // we're in a browser context and the clientWidth is available,\n                // use it to set calculate 'right'\n                right = document.documentElement.clientWidth - right;\n            }\n            // uses context to prioritize the previous positioning\n            let alignLeft = this.context.alignLeft || false;\n            if (alignLeft) {\n                if (submenuLeft - adjustmentWidth <= left) {\n                    alignLeft = false;\n                }\n            } else {\n                if (submenuRight >= right) {\n                    alignLeft = true;\n                }\n            }\n            this.setState({ alignLeft });\n        }\n    };\n\n    private renderChildren = () => {\n        const { children, submenu } = this.props;\n\n        if (children != null) {\n            const childProps = this.cascadeProps();\n            if (Object.keys(childProps).length === 0) {\n                return children;\n            } else {\n                return React.Children.map(children, (child: JSX.Element) => {\n                    return React.cloneElement(child, childProps);\n                });\n            }\n        } else if (submenu != null) {\n            return submenu.map(this.cascadeProps).map(renderMenuItem);\n        } else {\n            return undefined;\n        }\n    };\n\n    /**\n     * Evalutes this.props and cascades prop values into new props when:\n     * - submenuViewportMargin is defined, but is undefined for the supplied input.\n     * - useSmartPositioning is false, but is undefined for the supplied input.\n     * @param {IMenuItemProps} newProps If supplied, object will be modified, otherwise, defaults to an empty object.\n     * @returns An object to be used as child props.\n     */\n    private cascadeProps = (newProps: IMenuItemProps = ({} as any) as IMenuItemProps) => {\n        const { submenuViewportMargin, useSmartPositioning } = this.props;\n\n        if (submenuViewportMargin != null && newProps.submenuViewportMargin == null) {\n            newProps.submenuViewportMargin = submenuViewportMargin;\n        }\n        if (useSmartPositioning === false && newProps.useSmartPositioning == null) {\n            newProps.useSmartPositioning = useSmartPositioning;\n        }\n\n        return newProps;\n    };\n}\n\nexport function renderMenuItem(props: IMenuItemProps, key: string | number) {\n    return <MenuItem key={key} {...props} />;\n}\n\nexport const MenuItemFactory = React.createFactory(MenuItem);\n"]}